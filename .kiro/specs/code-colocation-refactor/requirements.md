# 需求文档

## 介绍

本项目旨在对整个代码库进行极致的代码就近管理（colocation）重构，特别针对 `src/app` 下的所有页面和 `src/components` 下的所有组件。将所有只属于特定页面或组件的 types、utils、lib、config、hooks 等代码迁移为内联代码或放置在同一文件夹中，实现每个页面和组件的完全独立性。这种重构将最大化代码的独立性、可维护性，并彻底消除不必要的全局依赖。

## 需求

### 需求 1

**用户故事：** 作为开发者，我希望将所有只属于 `src/app` 页面的类型定义迁移到页面文件内部或页面目录中，以便实现页面的完全独立性。

#### 验收标准

1. 当类型定义只被 `src/app` 下的单个页面使用时，系统应该将该类型定义迁移到页面文件内部或页面目录的 `types.ts` 文件中
2. 当类型定义只被页面目录下的多个文件使用时，系统应该在页面目录中创建本地的类型文件
3. 当类型定义被迁移后，系统应该移除全局类型文件中的相应定义并更新所有导入引用

### 需求 2

**用户故事：** 作为开发者，我希望将所有只属于 `src/components` 组件的类型定义迁移到组件文件内部或组件目录中，以便实现组件的完全独立性。

#### 验收标准

1. 当类型定义只被 `src/components` 下的单个组件使用时，系统应该将该类型定义迁移到组件文件内部
2. 当类型定义只被组件目录下的多个文件使用时，系统应该在组件目录中创建本地的 `types.ts` 文件
3. 当类型定义被迁移后，系统应该移除全局类型文件中的相应定义并更新所有导入引用

### 需求 3

**用户故事：** 作为开发者，我希望将所有只属于特定页面的工具函数迁移到页面内部或页面目录中，以便实现页面的完全自包含。

#### 验收标准

1. 当工具函数只被 `src/app` 下的单个页面使用时，系统应该将该函数迁移到页面文件内部或页面目录的 `utils.ts` 文件中
2. 当工具函数只被页面目录下的多个文件使用时，系统应该在页面目录中创建本地的工具函数文件
3. 当工具函数被迁移后，系统应该移除全局工具文件中的相应函数并更新所有导入引用

### 需求 4

**用户故事：** 作为开发者，我希望将所有只属于特定组件的工具函数迁移到组件内部或组件目录中，以便实现组件的完全自包含。

#### 验收标准

1. 当工具函数只被 `src/components` 下的单个组件使用时，系统应该将该函数迁移到组件文件内部或组件目录的 `utils.ts` 文件中
2. 当工具函数只被组件目录下的多个文件使用时，系统应该在组件目录中创建本地的工具函数文件
3. 当工具函数被迁移后，系统应该移除全局工具文件中的相应函数并更新所有导入引用

### 需求 5

**用户故事：** 作为开发者，我希望将所有只属于特定页面的配置迁移到页面内部或页面目录中，以便实现页面配置的完全独立。

#### 验收标准

1. 当配置只被 `src/app` 下的单个页面使用时，系统应该将该配置迁移到页面文件内部或页面目录的 `config.ts` 文件中
2. 当配置只被页面目录下的多个文件使用时，系统应该在页面目录中创建本地的配置文件
3. 当配置被迁移后，系统应该移除全局配置文件中的相应配置项并更新所有导入引用

### 需求 6

**用户故事：** 作为开发者，我希望将所有只属于特定组件的配置迁移到组件内部或组件目录中，以便实现组件配置的完全独立。

#### 验收标准

1. 当配置只被 `src/components` 下的单个组件使用时，系统应该将该配置迁移到组件文件内部或组件目录的 `config.ts` 文件中
2. 当配置只被组件目录下的多个文件使用时，系统应该在组件目录中创建本地的配置文件
3. 当配置被迁移后，系统应该移除全局配置文件中的相应配置项并更新所有导入引用

### 需求 7

**用户故事：** 作为开发者，我希望将所有只属于特定页面的 hooks 迁移到页面内部或页面目录中，以便实现页面逻辑的完全独立。

#### 验收标准

1. 当 hook 只被 `src/app` 下的单个页面使用时，系统应该将该 hook 迁移到页面文件内部或页面目录的 `hooks.ts` 文件中
2. 当 hook 只被页面目录下的多个文件使用时，系统应该在页面目录中创建本地的 hooks 文件
3. 当 hook 被迁移后，系统应该移除全局 hooks 文件中的相应 hook 并更新所有导入引用

### 需求 8

**用户故事：** 作为开发者，我希望将所有只属于特定组件的 hooks 迁移到组件内部或组件目录中，以便实现组件逻辑的完全独立。

#### 验收标准

1. 当 hook 只被 `src/components` 下的单个组件使用时，系统应该将该 hook 迁移到组件文件内部或组件目录的 `hooks.ts` 文件中
2. 当 hook 只被组件目录下的多个文件使用时，系统应该在组件目录中创建本地的 hooks 文件
3. 当 hook 被迁移后，系统应该移除全局 hooks 文件中的相应 hook 并更新所有导入引用

### 需求 9

**用户故事：** 作为开发者，我希望将所有只属于特定页面或组件的库函数迁移到对应的内部，以便实现完全的代码独立性。

#### 验收标准

1. 当库函数只被 `src/app` 下的单个页面使用时，系统应该将该函数迁移到页面文件内部或页面目录的 `lib.ts` 文件中
2. 当库函数只被 `src/components` 下的单个组件使用时，系统应该将该函数迁移到组件文件内部或组件目录的 `lib.ts` 文件中
3. 当库函数被迁移后，系统应该移除全局库文件中的相应函数并更新所有导入引用

### 需求 10

**用户故事：** 作为开发者，我希望只保留真正被多个不相关页面或组件共享的代码在全局目录中，以便维持最小化的全局依赖。

#### 验收标准

1. 当代码被多个不相关的页面或组件使用时，系统应该保留该代码在全局共享目录中
2. 当评估代码共享性时，系统应该分析实际的使用情况，优先选择代码就近管理
3. 当重构完成后，系统应该确保全局目录只包含真正必需的共享代码

### 需求 11

**用户故事：** 作为开发者，我希望重构过程不会破坏现有的功能，以便确保系统的稳定性和可靠性。

#### 验收标准

1. 当进行代码迁移时，系统应该保持所有现有功能的正常运行
2. 当更新导入路径时，系统应该确保所有引用都正确解析
3. 当重构完成后，系统应该通过测试验证功能完整性和类型检查通过
