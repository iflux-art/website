---
title: 搜索API接口
description: 全局搜索API接口详细说明
date: 2025-08-29
category: API
tags:
  - API
  - 搜索
  - 接口文档
---

# 搜索API接口

搜索API接口提供跨模块内容搜索能力，支持博客、文档、链接等多源数据搜索。

## 基础信息

### 基础URL

```
/api/search
```

### 认证要求

所有接口均为公开访问，无需认证。

## 接口列表

### 1. 全局搜索

```
GET /api/search
```

跨博客、文档、链接模块搜索内容。

#### 请求参数

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| q | string | 是 | 搜索关键词 |
| limit | integer | 否 | 结果数量限制，默认为10，最大50 |

#### 响应示例

```json
{
  "success": true,
  "data": {
    "results": [
      {
        "type": "blog",
        "title": "Next.js入门指南",
        "description": "从零开始学习Next.js框架",
        "path": "/blog/getting-started-with-nextjs",
        "excerpt": "Next.js是一个React框架，它提供了服务器端渲染、静态生成等特性...",
        "date": "2025-08-29"
      },
      {
        "type": "doc",
        "title": "快速开始",
        "description": "快速开始使用和开发斐流艺创项目",
        "path": "/docs/getting-started",
        "excerpt": "本文档将指导您如何快速设置开发环境并运行斐流艺创项目...",
        "date": "2025-08-29"
      },
      {
        "type": "link",
        "title": "GitHub",
        "description": "代码托管与版本控制平台",
        "path": "/links",
        "url": "https://github.com/iflux-art"
      }
    ],
    "total": 3,
    "took": 45 // 搜索耗时（毫秒）
  },
  "timestamp": "2025-08-29T12:00:00Z"
}
```

### 2. 博客搜索

```
GET /api/search/blog
```

专门搜索博客内容。

#### 请求参数

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| q | string | 是 | 搜索关键词 |
| limit | integer | 否 | 结果数量限制，默认为5，最大20 |

#### 响应示例

```json
{
  "success": true,
  "data": {
    "results": [
      {
        "type": "blog",
        "title": "Next.js入门指南",
        "description": "从零开始学习Next.js框架",
        "path": "/blog/getting-started-with-nextjs",
        "excerpt": "Next.js是一个React框架，它提供了服务器端渲染、静态生成等特性...",
        "date": "2025-08-29"
      }
    ],
    "total": 1,
    "took": 25
  },
  "timestamp": "2025-08-29T12:00:00Z"
}
```

### 3. 文档搜索

```
GET /api/search/docs
```

专门搜索文档内容。

#### 请求参数

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| q | string | 是 | 搜索关键词 |
| limit | integer | 否 | 结果数量限制，默认为5，最大20 |

#### 响应示例

```json
{
  "success": true,
  "data": {
    "results": [
      {
        "type": "doc",
        "title": "快速开始",
        "description": "快速开始使用和开发斐流艺创项目",
        "path": "/docs/getting-started",
        "excerpt": "本文档将指导您如何快速设置开发环境并运行斐流艺创项目...",
        "date": "2025-08-29"
      }
    ],
    "total": 1,
    "took": 20
  },
  "timestamp": "2025-08-29T12:00:00Z"
}
```

### 4. 链接搜索

```
GET /api/search/links
```

专门搜索链接内容。

#### 请求参数

| 参数名 | 类型 | 必需 | 描述 |
|--------|------|------|------|
| q | string | 是 | 搜索关键词 |
| limit | integer | 否 | 结果数量限制，默认为5，最大20 |

#### 响应示例

```json
{
  "success": true,
  "data": {
    "results": [
      {
        "type": "link",
        "title": "GitHub",
        "description": "代码托管与版本控制平台",
        "path": "/links",
        "url": "https://github.com/iflux-art"
      }
    ],
    "total": 1,
    "took": 15
  },
  "timestamp": "2025-08-29T12:00:00Z"
}
```

## 数据结构

### 搜索结果

```typescript
interface SearchResult {
  type: 'link' | 'blog' | 'doc';
  title: string;
  description?: string;
  path?: string; // 本地路径
  url?: string; // 外部链接
  excerpt?: string; // 内容摘要
  date?: string; // ISO 8601格式日期
}
```

### 搜索响应

```typescript
interface SearchResponse {
  success: boolean;
  data: {
    results: SearchResult[];
    total: number;
    took: number; // 搜索耗时（毫秒）
  };
  timestamp: string;
}
```

## 错误响应

### 400 - 参数错误

```json
{
  "success": false,
  "error": {
    "code": "INVALID_PARAMETERS",
    "message": "参数验证失败",
    "details": {
      "q": "搜索关键词不能为空"
    }
  },
  "timestamp": "2025-08-29T12:00:00Z"
}
```

### 429 - 请求过于频繁

```json
{
  "success": false,
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "请求过于频繁，请稍后再试"
  },
  "timestamp": "2025-08-29T12:00:00Z"
}
```

## 使用示例

### JavaScript (fetch)

```javascript
// 全局搜索
async function globalSearch(query, limit = 10) {
  try {
    const response = await fetch(`/api/search?q=${encodeURIComponent(query)}&limit=${limit}`);
    const result = await response.json();
    
    if (result.success) {
      console.log('搜索结果:', result.data.results);
      console.log('总计:', result.data.total);
      console.log('耗时:', result.data.took, 'ms');
    } else {
      console.error('搜索失败:', result.error.message);
    }
  } catch (error) {
    console.error('网络错误:', error);
  }
}

// 博客搜索
async function blogSearch(query, limit = 5) {
  try {
    const response = await fetch(`/api/search/blog?q=${encodeURIComponent(query)}&limit=${limit}`);
    const result = await response.json();
    
    if (result.success) {
      console.log('博客搜索结果:', result.data.results);
    } else {
      console.error('搜索失败:', result.error.message);
    }
  } catch (error) {
    console.error('网络错误:', error);
  }
}

// 文档搜索
async function docsSearch(query, limit = 5) {
  try {
    const response = await fetch(`/api/search/docs?q=${encodeURIComponent(query)}&limit=${limit}`);
    const result = await response.json();
    
    if (result.success) {
      console.log('文档搜索结果:', result.data.results);
    } else {
      console.error('搜索失败:', result.error.message);
    }
  } catch (error) {
    console.error('网络错误:', error);
  }
}
```

### Python (requests)

```python
import requests

# 全局搜索
def global_search(query, limit=10):
    try:
        response = requests.get(
            'https://your-domain.com/api/search',
            params={'q': query, 'limit': limit}
        )
        result = response.json()
        
        if result['success']:
            print('搜索结果:', result['data']['results'])
            print('总计:', result['data']['total'])
            print('耗时:', result['data']['took'], 'ms')
        else:
            print('搜索失败:', result['error']['message'])
    except Exception as error:
        print('网络错误:', error)

# 博客搜索
def blog_search(query, limit=5):
    try:
        response = requests.get(
            'https://your-domain.com/api/search/blog',
            params={'q': query, 'limit': limit}
        )
        result = response.json()
        
        if result['success']:
            print('博客搜索结果:', result['data']['results'])
        else:
            print('搜索失败:', result['error']['message'])
    except Exception as error:
        print('网络错误:', error)
```

## 性能优化

### 1. 内存缓存

后端API使用内存缓存存储扫描到的数据，避免每次搜索都重新扫描文件系统。

### 2. 结果限制

- 单个数据源限制返回5条结果
- 全局搜索总计限制返回10条结果
- 控制数据传输量，提高响应速度

### 3. 异步处理

所有文件读取和网络请求均使用异步处理，保证UI流畅性。

## 速率限制

- 每个IP每分钟最多60次搜索请求
- 超过限制时返回429状态码

## 更新日志

### v1.0.0 (2025-08-29)

- 初始化搜索API接口
- 实现全局搜索和分类搜索接口

## 注意事项

1. 搜索关键词不能为空
2. 搜索结果按相关性排序
3. excerpt字段包含匹配关键词的上下文
4. 外部链接使用url字段，内部页面使用path字段
5. 建议客户端实现防抖机制避免频繁请求
6. 搜索结果可能包含HTML标签，使用时请注意转义

通过这些API接口，开发者可以轻松地在自己的应用中集成搜索功能，实现跨模块内容搜索。